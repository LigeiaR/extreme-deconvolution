language: c
compiler:
  - clang
  - gcc
env:
  matrix:
    - TRAVIS_PYTHON_VERSION=2.7
    - TRAVIS_PYTHON_VERSION=3.5
addons:
  apt:
    sources:
      - deadsnakes
    packages:
     - libgsl0-dev
     - python$PYTHON_TRAVIS_VERSION
before_install:
 #Setup conda for faster installs
 - wget http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh -O miniconda.sh
 - bash miniconda.sh -b -p $HOME/miniconda
 - export PATH="$HOME/miniconda/bin:$PATH"
 - hash -r
 - conda config --set always_yes yes --set changeps1 no
 - conda update -q conda
 - conda create -q -n test-environment python=$TRAVIS_PYTHON_VERSION numpy scipy matplotlib setuptools pip pytest
 - source activate test-environment
 - sudo pip install pytest-cov
install:
 - make
 - sudo make install
 - make pywrapper
script:
 - export PYTHONPATH=$PYTHONPATH:$PWD/py
 - cd tests/
 - pytest -v test_basic.py --cov=extreme_deconvolution
notifications:
  email:
    recipients:
      - jo.bovy@gmail.com
    on_success: change
    on_failure: change
